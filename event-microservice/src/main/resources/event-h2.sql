CREATE DATABASE events_data
WITH
    OWNER = postgres
    ENCODING = 'UTF8'
    CONNECTION LIMIT = -1;

CREATE TABLE if not exists public.product
(
    id           INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name         VARCHAR(255),
    availability BOOLEAN,
    CONSTRAINT pk_product PRIMARY KEY (id)
);
CREATE TABLE if not exists public.event
(
    id    INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name  VARCHAR(255),
    price FLOAT,
    CONSTRAINT pk_event PRIMARY KEY (id)
);
CREATE TABLE if not exists public.bill
(
    id           INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    user_name    VARCHAR(255)                             NOT NULL,
    email        VARCHAR(255),
    event_id     INTEGER,
    total_amount FLOAT                                    NOT NULL,
    date         date,
    finished     BOOLEAN,
    CONSTRAINT pk_bill PRIMARY KEY (id)
);
CREATE TABLE if not exists event_products
(
    event_id integer NOT NULL,
    products_id integer NOT NULL,
    CONSTRAINT fk2haxatw1xtgov5gf8lyat5aul FOREIGN KEY (products_id)
        REFERENCES public.product (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fkdnw96ssg8ohkmji7y3nxr24s5 FOREIGN KEY (event_id)
        REFERENCES public.event (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

ALTER TABLE bill
    ADD CONSTRAINT FK_BILL_ON_EVENT FOREIGN KEY (event_id) REFERENCES event (id);

insert into product (id ,name, availability) values (1, 'Camera', true);
insert into product (id, name, availability) values (2, 'Tripo', true);
insert into product (id, name, availability) values (3, 'Lights', true);
insert into product (id, name, availability) values (4, 'Video Camera', true);
insert into product (id, name, availability) values (5, 'Decoration', true);
insert into event (id, name, price) values (1, 'Pre-Wedding', 1000);
insert into event_products (event_id, products_id) values (1,1);
insert into event_products (event_id, products_id) values (1,4);
insert into event (id, name, price) values (2, 'Wedding', 5000);
insert into event_products (event_id, products_id) values (2,1);
insert into event_products (event_id, products_id) values (2,4);
insert into event_products (event_id, products_id) values (2,3);
insert into event_products (event_id, products_id) values (2,2);
insert into event_products (event_id, products_id) values (2,5);
insert into event (id, name, price) values (3, 'Birthday', 3000);
insert into event_products (event_id, products_id) values (3,1);
insert into event_products (event_id, products_id) values (3,3);
insert into event_products (event_id, products_id) values (3,5);
insert into event (id, name, price) values (4, 'Event Video', 4000);
insert into event_products (event_id, products_id) values (4,4);
insert into event_products (event_id, products_id) values (4,2);
